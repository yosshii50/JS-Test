<html>
<meta http-equiv="content-type" charset="utf-8">
<head>
<title>Test11_ScrollBar</title>
</head>
<body>

Wak_StartPos:<span id="Wak_StartPos"></span><br>
Wak_Width:<span id="Wak_Width"></span><br>
Box_StartPos:<span id="Box_StartPos"></span><br>
Box_Width:<span id="Box_Width"></span><br>
Box_LeftPos:<span id="Box_LeftPos"></span><br>
Box_PosX:<span id="Box_PosX"></span><br>
Mouse_Offset:<span id="Mouse_Offset"></span><br>
Mouse_Button:<span id="Mouse_Button"></span><br>
onmousedown_event_clientX:<span id="onmousedown_event_clientX"></span><br>
<br>
<br>

<div id="app">
<canvas id="Wak_CanvasID" width="300" height="100"></canvas>
<canvas id="Box_CanvasID" width="100" height="100"></canvas>
</div>

<script language="JavaScript">
//=========================================================================================================================

var Wak_Element = document.getElementById("Wak_CanvasID");
var Box_Element = document.getElementById("Box_CanvasID");
var Box_PosX=0;
var Mouse_Offset=0;

onload = function() {
	
	// Waku
	var Waku_Context = Wak_Element.getContext("2d");
//	Waku_Context.beginPath();
	Waku_Context.strokeRect(0, 0, 300, 100);
	
	Wak_Element.style.position = "absolute";
	
	document.getElementById("Wak_StartPos").innerHTML = Wak_Element.getBoundingClientRect().left;
	document.getElementById("Wak_Width").innerHTML = Wak_Element.getBoundingClientRect().width;
	
	// Box
	var Box_Context = Box_Element.getContext("2d");
//	Box_Context.beginPath();
	Box_Context.strokeRect(0, 0, 100, 100);
	Box_Context.fillStyle = "rgb(127, 127, 127)";
	Box_Context.fillRect(0, 0, 100, 100);
//	Box_Context.strokeStyle = 'red';
//	Box_Context.fill();
//	Box_Context.stroke();
	Box_Element.style.position = "absolute";
	Box_PosX = Box_Element.getBoundingClientRect().left;
	
	document.getElementById("Box_PosX").innerHTML = Box_PosX;
	document.getElementById("Box_StartPos").innerHTML = Box_Element.getBoundingClientRect().left;
	document.getElementById("Box_Width").innerHTML = Box_Element.getBoundingClientRect().width;
	
}

document.getElementById("Box_PosX").onclick = function() {
	document.getElementById("Box_PosX").innerHTML = Box_PosX;
};

Box_Element.ondragstart = function(event){
	return false;
}

Box_Element.onmousedown = function(event){
	MouseDownEve(event,"mousemove");
}
Box_Element.onpointerdown = function(event){
	MouseDownEve(event,"pointermove");
}
function MouseDownEve(event,EventName){
	
	Mouse_Offset = event.clientX - Box_PosX;
	
	document.getElementById("Box_LeftPos").innerHTML = Box_Element.style.left;
	document.getElementById("Mouse_Offset").innerHTML = Mouse_Offset;
	document.getElementById("onmousedown_event_clientX").innerHTML = event.clientX;
	
	document.addEventListener(EventName,OnMouseMove);
}

Box_Element.onmouseup = function(event){
	MouseDownEve("mousemove");
}
Box_Element.onpointerup = function(event){
	MouseDownEve("pointermove");
}
function MouseUpEve(EventName){
	document.removeEventListener("pointermove",OnMouseMove);
}





var OnMouseMove = function(event){
	
	
	
	if(event.buttons !== undefined){
	
		
		var button_l = ((event.buttons & 0x0001) ? true : false);
		
		document.getElementById("Mouse_Button").innerHTML = button_l;
		
		if( ((event.buttons & 0x0001) ? true : false) == false ){
			return;
		}
		
	}
	
	
	
	
	Box_PosX = event.clientX;
	
	Box_PosX = Box_PosX - Mouse_Offset;
	
	// Left Max
	if( Box_PosX < Wak_Element.getBoundingClientRect().left ){
		Box_PosX = Wak_Element.getBoundingClientRect().left;
	}
	
	// Right Max
	if( Box_PosX > Wak_Element.getBoundingClientRect().width
	             - Box_Element.getBoundingClientRect().width
	             + Wak_Element.getBoundingClientRect().left ){
		Box_PosX = Wak_Element.getBoundingClientRect().width
		         - Box_Element.getBoundingClientRect().width
		         + Wak_Element.getBoundingClientRect().left;
	}
	
	Box_Element.style.left = Box_PosX + "px";
	
	document.getElementById("Box_LeftPos").innerHTML = Box_Element.style.left;
	document.getElementById("Box_PosX").innerHTML = Box_PosX;
}

</script>



</body>
</html>
